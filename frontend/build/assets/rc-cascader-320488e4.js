import{K as le,p as We,f as He}from"./rc-util-49c06749.js";import{f as Q,e as ve,b as W,d as Ue,c as ue,g as je,h as sn}from"./@babel-43e769cc.js";import{u as Re,b as dn,B as vn}from"./rc-select-04838821.js";import{r}from"./react-52c5f799.js";import{c as fn,d as De}from"./rc-tree-9ea13a9a.js";import{c as Ke}from"./classnames-5da7e38f.js";import"./react-is-e8e5dbb3.js";var _e=r.createContext(null),be="__rc_cascader_search_mark__",hn=function(n,a,t){var o=t.label;return a.some(function(i){return String(i[o]).toLowerCase().includes(n.toLowerCase())})},pn=function(n,a,t,o){return a.map(function(i){return i[o.label]}).join(" / ")};const mn=function(e,n,a,t,o,i){var l=o.filter,s=l===void 0?hn:l,d=o.render,c=d===void 0?pn:d,x=o.limit,g=x===void 0?50:x,P=o.sort;return r.useMemo(function(){var C=[];if(!e)return[];function p(k,v){k.forEach(function(V){if(!(!P&&g>0&&C.length>=g)){var L=[].concat(Q(v),[V]),q=V[a.children];if((!q||q.length===0||i)&&s(e,L,{label:a.label})){var f;C.push(ve(ve({},V),{},(f={},W(f,a.label,c(e,L,t,a)),W(f,be,L),W(f,a.children,void 0),f)))}q&&p(V[a.children],L)}})}return p(n,[]),P&&C.sort(function(k,v){return P(k[be],v[be],e,a)}),g>0?C.slice(0,g):C},[e,n,a,t,c,i,s,P,g])};var Te="__RC_CASCADER_SPLIT__",Xe="SHOW_PARENT",qe="SHOW_CHILD";function Z(e){return e.join(Te)}function Ce(e){return e.map(Z)}function gn(e){return e.split(Te)}function Cn(e){var n=e||{},a=n.label,t=n.value,o=n.children,i=t||"value";return{label:a||"label",value:i,key:i,children:o||"children"}}function Pe(e,n){var a,t;return(a=e.isLeaf)!==null&&a!==void 0?a:!((t=e[n.children])!==null&&t!==void 0&&t.length)}function bn(e){var n=e.parentElement;if(n){var a=e.offsetTop-n.offsetTop;a-n.scrollTop<0?n.scrollTo({top:a}):a+e.offsetHeight-n.scrollTop>n.offsetHeight&&n.scrollTo({top:a+e.offsetHeight-n.offsetHeight})}}function Ge(e,n){return e.map(function(a){var t;return(t=a[be])===null||t===void 0?void 0:t.map(function(o){return o[n.value]})})}function Fe(e,n,a){var t=new Set(e),o=n();return e.filter(function(i){var l=o[i],s=l?l.parent:null,d=l?l.children:null;return l&&l.node.disabled?!0:a===qe?!(d&&d.some(function(c){return c.key&&t.has(c.key)})):!(s&&!s.node.disabled&&t.has(s.key))})}function Ve(e,n,a){for(var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=n,i=[],l=function(){var c,x,g,P=e[s],C=(c=o)===null||c===void 0?void 0:c.findIndex(function(k){var v=k[a.value];return t?String(v)===String(P):v===P}),p=C!==-1?(x=o)===null||x===void 0?void 0:x[C]:null;i.push({value:(g=p==null?void 0:p[a.value])!==null&&g!==void 0?g:P,index:C,option:p}),o=p==null?void 0:p[a.children]},s=0;s<e.length;s+=1)l();return i}const Sn=function(e,n,a,t,o){return r.useMemo(function(){var i=o||function(l){var s=t?l.slice(-1):l,d=" / ";return s.every(function(c){return["string","number"].includes(Ue(c))})?s.join(d):s.reduce(function(c,x,g){var P=r.isValidElement(x)?r.cloneElement(x,{key:g}):x;return g===0?[P]:[].concat(Q(c),[d,P])},[])};return e.map(function(l){var s,d,c=Ve(l,n,a),x=i(c.map(function(P){var C,p=P.option,k=P.value;return(C=p==null?void 0:p[a.label])!==null&&C!==void 0?C:k}),c.map(function(P){var C=P.option;return C})),g=Z(l);return{label:x,value:g,key:g,valueCells:l,disabled:(s=c[c.length-1])===null||s===void 0||(d=s.option)===null||d===void 0?void 0:d.disabled}})},[e,n,a,o,t])},kn=function(e,n){var a=r.useRef({options:null,info:null}),t=r.useCallback(function(){return a.current.options!==e&&(a.current.options=e,a.current.info=fn(e,{fieldNames:n,initWrapper:function(i){return ve(ve({},i),{},{pathKeyEntities:{}})},processEntity:function(i,l){var s=i.nodes.map(function(d){return d[n.value]}).join(Te);l.pathKeyEntities[s]=i,i.key=s}})),a.current.info.pathKeyEntities},[n,e]);return t},yn=function(e,n){return r.useCallback(function(a){var t=[],o=[];return a.forEach(function(i){var l=Ve(i,e,n);l.every(function(s){return s.option})?o.push(i):t.push(i)}),[o,t]},[e,n])};function xn(e){return r.useMemo(function(){if(!e)return[!1,{}];var n={matchInputWidth:!0,limit:50};return e&&Ue(e)==="object"&&(n=ve(ve({},n),e)),n.limit<=0&&delete n.limit,[!0,n]},[e])}var Pn=r.memo(function(e){var n=e.children;return n},function(e,n){return!n.open});function Vn(e){var n,a=e.prefixCls,t=e.checked,o=e.halfChecked,i=e.disabled,l=e.onClick,s=e.disableCheckbox,d=r.useContext(_e),c=d.checkable,x=typeof c!="boolean"?c:null;return r.createElement("span",{className:Ke("".concat(a),(n={},W(n,"".concat(a,"-checked"),t),W(n,"".concat(a,"-indeterminate"),!t&&o),W(n,"".concat(a,"-disabled"),i||s),n)),onClick:l},x)}var Je="__cascader_fix_label__";function _n(e){var n=e.prefixCls,a=e.multiple,t=e.options,o=e.activeValue,i=e.prevValuePath,l=e.onToggleOpen,s=e.onSelect,d=e.onActive,c=e.checkedSet,x=e.halfCheckedSet,g=e.loadingKeys,P=e.isSelectable,C=e.searchValue,p="".concat(n,"-menu"),k="".concat(n,"-menu-item"),v=r.useContext(_e),V=v.fieldNames,L=v.changeOnSelect,q=v.expandTrigger,f=v.expandIcon,ee=v.loadingIcon,A=v.dropdownMenuColumnStyle,b=q==="hover",O=r.useMemo(function(){return t.map(function(u){var S,h=u.disabled,D=u.disableCheckbox,H=u[be],I=(S=u[Je])!==null&&S!==void 0?S:u[V.label],$=u[V.value],B=Pe(u,V),re=H?H.map(function(F){return F[V.value]}):[].concat(Q(i),[$]),R=Z(re),U=g.includes(R),G=c.has(R),_=x.has(R);return{disabled:h,label:I,value:$,isLeaf:B,isLoading:U,checked:G,halfChecked:_,option:u,disableCheckbox:D,fullPath:re,fullPathKey:R}})},[t,c,V,x,g,i]);return r.createElement("ul",{className:p,role:"menu"},O.map(function(u){var S,h=u.disabled,D=u.label,H=u.value,I=u.isLeaf,$=u.isLoading,B=u.checked,re=u.halfChecked,R=u.option,U=u.fullPath,G=u.fullPathKey,_=u.disableCheckbox,F=function(){if(!(h||C)){var X=Q(U);b&&I&&X.pop(),d(X)}},fe=function(){P(R)&&s(U,I)},oe;return typeof R.title=="string"?oe=R.title:typeof D=="string"&&(oe=D),r.createElement("li",{key:G,className:Ke(k,(S={},W(S,"".concat(k,"-expand"),!I),W(S,"".concat(k,"-active"),o===H||o===G),W(S,"".concat(k,"-disabled"),h),W(S,"".concat(k,"-loading"),$),S)),style:A,role:"menuitemcheckbox",title:oe,"aria-checked":B,"data-path-key":G,onClick:function(){F(),!_&&(!a||I)&&fe()},onDoubleClick:function(){L&&l(!1)},onMouseEnter:function(){b&&F()},onMouseDown:function(X){X.preventDefault()}},a&&r.createElement(Vn,{prefixCls:"".concat(n,"-checkbox"),checked:B,halfChecked:re,disabled:h||_,disableCheckbox:_,onClick:function(X){_||(X.stopPropagation(),fe())}}),r.createElement("div",{className:"".concat(k,"-content")},D),!$&&f&&!I&&r.createElement("div",{className:"".concat(k,"-expand-icon")},f),$&&ee&&r.createElement("div",{className:"".concat(k,"-loading-icon")},ee))}))}const On=function(){var e=Re(),n=e.multiple,a=e.open,t=r.useContext(_e),o=t.values,i=r.useState([]),l=ue(i,2),s=l[0],d=l[1];return r.useEffect(function(){if(a&&!n){var c=o[0];d(c||[])}},[a]),[s,d]},En=function(e,n,a,t,o,i){var l=Re(),s=l.direction,d=l.searchValue,c=l.toggleOpen,x=l.open,g=s==="rtl",P=r.useMemo(function(){for(var A=-1,b=n,O=[],u=[],S=t.length,h=Ge(n,a),D=function(R){var U=b.findIndex(function(G,_){return(h[_]?Z(h[_]):G[a.value])===t[R]});if(U===-1)return"break";A=U,O.push(A),u.push(t[R]),b=b[A][a.children]},H=0;H<S&&b;H+=1){var I=D(H);if(I==="break")break}for(var $=n,B=0;B<O.length-1;B+=1)$=$[O[B]][a.children];return[u,A,$,h]},[t,a,n]),C=ue(P,4),p=C[0],k=C[1],v=C[2],V=C[3],L=function(b){o(b)},q=function(b){var O=v.length,u=k;u===-1&&b<0&&(u=O);for(var S=0;S<O;S+=1){u=(u+b+O)%O;var h=v[u];if(h&&!h.disabled){var D=p.slice(0,-1).concat(V[u]?Z(V[u]):h[a.value]);L(D);return}}},f=function(){if(p.length>1){var b=p.slice(0,-1);L(b)}else c(!1)},ee=function(){var b,O=((b=v[k])===null||b===void 0?void 0:b[a.children])||[],u=O.find(function(h){return!h.disabled});if(u){var S=[].concat(Q(p),[u[a.value]]);L(S)}};r.useImperativeHandle(e,function(){return{onKeyDown:function(b){var O=b.which;switch(O){case le.UP:case le.DOWN:{var u=0;O===le.UP?u=-1:O===le.DOWN&&(u=1),u!==0&&q(u);break}case le.LEFT:{if(d)break;g?ee():f();break}case le.RIGHT:{if(d)break;g?f():ee();break}case le.BACKSPACE:{d||f();break}case le.ENTER:{if(p.length){var S=v[k],h=(S==null?void 0:S[be])||[];h.length?i(h.map(function(D){return D[a.value]}),h[h.length-1]):i(p,v[k])}break}case le.ESC:c(!1),x&&b.stopPropagation()}},onKeyUp:function(){}}})};var wn=r.forwardRef(function(e,n){var a,t,o,i,l=Re(),s=l.prefixCls,d=l.multiple,c=l.searchValue,x=l.toggleOpen,g=l.notFoundContent,P=l.direction,C=l.open,p=r.useRef(),k=P==="rtl",v=r.useContext(_e),V=v.options,L=v.values,q=v.halfValues,f=v.fieldNames,ee=v.changeOnSelect,A=v.onSelect,b=v.searchOptions,O=v.dropdownPrefixCls,u=v.loadData,S=v.expandTrigger,h=O||s,D=r.useState([]),H=ue(D,2),I=H[0],$=H[1],B=function(m){if(!(!u||c)){var E=Ve(m,V,f),w=E.map(function(se){var me=se.option;return me}),N=w[w.length-1];if(N&&!Pe(N,f)){var ae=Z(m);$(function(se){return[].concat(Q(se),[ae])}),u(w)}}};r.useEffect(function(){I.length&&I.forEach(function(M){var m=gn(M),E=Ve(m,V,f,!0).map(function(N){var ae=N.option;return ae}),w=E[E.length-1];(!w||w[f.children]||Pe(w,f))&&$(function(N){return N.filter(function(ae){return ae!==M})})})},[V,I,f]);var re=r.useMemo(function(){return new Set(Ce(L))},[L]),R=r.useMemo(function(){return new Set(Ce(q))},[q]),U=On(),G=ue(U,2),_=G[0],F=G[1],fe=function(m){F(m),B(m)},oe=function(m){var E=m.disabled,w=Pe(m,f);return!E&&(w||ee||d)},j=function(m,E){var w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;A(m),!d&&(E||ee&&(S==="hover"||w))&&x(!1)},X=r.useMemo(function(){return c?b:V},[c,b,V]),J=r.useMemo(function(){for(var M=[{options:X}],m=X,E=Ge(m,f),w=function(){var me=_[N],Se=m.find(function(de,ge){return(E[ge]?Z(E[ge]):de[f.value])===me}),ie=Se==null?void 0:Se[f.children];if(!(ie!=null&&ie.length))return"break";m=ie,M.push({options:ie})},N=0;N<_.length;N+=1){var ae=w();if(ae==="break")break}return M},[X,_,f]),ne=function(m,E){oe(E)&&j(m,Pe(E,f),!0)};En(n,X,f,_,fe,ne),r.useEffect(function(){for(var M=0;M<_.length;M+=1){var m,E=_.slice(0,M+1),w=Z(E),N=(m=p.current)===null||m===void 0?void 0:m.querySelector('li[data-path-key="'.concat(w.replace(/\\{0,2}"/g,'\\"'),'"]'));N&&bn(N)}},[_]);var Y=!((a=J[0])!==null&&a!==void 0&&(t=a.options)!==null&&t!==void 0&&t.length),ce=[(o={},W(o,f.value,"__EMPTY__"),W(o,Je,g),W(o,"disabled",!0),o)],Me=ve(ve({},e),{},{multiple:!Y&&d,onSelect:j,onActive:fe,onToggleOpen:x,checkedSet:re,halfCheckedSet:R,loadingKeys:I,isSelectable:oe}),Oe=Y?[{options:ce}]:J,pe=Oe.map(function(M,m){var E=_.slice(0,m),w=_[m];return r.createElement(_n,je({key:m},Me,{searchValue:c,prefixCls:h,options:M.options,prevValuePath:E,activeValue:w}))});return r.createElement(Pn,{open:C},r.createElement("div",{className:Ke("".concat(h,"-menus"),(i={},W(i,"".concat(h,"-menu-empty"),Y),W(i,"".concat(h,"-rtl"),k),i)),ref:p},pe))}),Mn=["id","prefixCls","fieldNames","defaultValue","value","changeOnSelect","onChange","displayRender","checkable","searchValue","onSearch","showSearch","expandTrigger","options","dropdownPrefixCls","loadData","popupVisible","open","popupClassName","dropdownClassName","dropdownMenuColumnStyle","popupPlacement","placement","onDropdownVisibleChange","onPopupVisibleChange","expandIcon","loadingIcon","children","dropdownMatchSelectWidth","showCheckedStrategy"];function In(e){return Array.isArray(e)&&Array.isArray(e[0])}function Be(e){return e?In(e)?e:(e.length===0?[]:[e]).map(function(n){return Array.isArray(n)?n:[n]}):[]}var Ye=r.forwardRef(function(e,n){var a=e.id,t=e.prefixCls,o=t===void 0?"rc-cascader":t,i=e.fieldNames,l=e.defaultValue,s=e.value,d=e.changeOnSelect,c=e.onChange,x=e.displayRender,g=e.checkable,P=e.searchValue,C=e.onSearch,p=e.showSearch,k=e.expandTrigger,v=e.options,V=e.dropdownPrefixCls,L=e.loadData,q=e.popupVisible,f=e.open,ee=e.popupClassName,A=e.dropdownClassName,b=e.dropdownMenuColumnStyle,O=e.popupPlacement,u=e.placement,S=e.onDropdownVisibleChange,h=e.onPopupVisibleChange,D=e.expandIcon,H=D===void 0?">":D,I=e.loadingIcon,$=e.children,B=e.dropdownMatchSelectWidth,re=B===void 0?!1:B,R=e.showCheckedStrategy,U=R===void 0?Xe:R,G=sn(e,Mn),_=dn(a),F=!!g,fe=We(l,{value:s,postState:Be}),oe=ue(fe,2),j=oe[0],X=oe[1],J=r.useMemo(function(){return Cn(i)},[JSON.stringify(i)]),ne=r.useMemo(function(){return v||[]},[v]),Y=kn(ne,J),ce=r.useCallback(function(K){var y=Y();return K.map(function(T){var te=y[T].nodes;return te.map(function(z){return z[J.value]})})},[Y,J]),Me=We("",{value:P,postState:function(y){return y||""}}),Oe=ue(Me,2),pe=Oe[0],M=Oe[1],m=function(y,T){M(y),T.source!=="blur"&&C&&C(y)},E=xn(p),w=ue(E,2),N=w[0],ae=w[1],se=mn(pe,ne,J,V||o,ae,d),me=yn(ne,J),Se=r.useMemo(function(){var K=me(j),y=ue(K,2),T=y[0],te=y[1];if(!F||!j.length)return[T,[],te];var z=Ce(T),ye=Y(),he=De(z,!0,ye),Ee=he.checkedKeys,we=he.halfCheckedKeys;return[ce(Ee),ce(we),te]},[F,j,Y,ce,me]),ie=ue(Se,3),de=ie[0],ge=ie[1],ke=ie[2],ze=r.useMemo(function(){var K=Ce(de),y=Fe(K,Y,U);return[].concat(Q(ke),Q(ce(y)))},[de,Y,ce,ke,U]),Qe=Sn(ze,ne,J,F,x),Ie=He(function(K){if(X(K),c){var y=Be(K),T=y.map(function(ye){return Ve(ye,ne,J).map(function(he){return he.option})}),te=F?y:y[0],z=F?T:T[0];c(te,z)}}),Le=He(function(K){if(M(""),!F)Ie(K);else{var y=Z(K),T=Ce(de),te=Ce(ge),z=T.includes(y),ye=ke.some(function(xe){return Z(xe)===y}),he=de,Ee=ke;if(ye&&!z)Ee=ke.filter(function(xe){return Z(xe)!==y});else{var we=z?T.filter(function(xe){return xe!==y}):[].concat(Q(T),[y]),Ne=Y(),Ae;if(z){var ln=De(we,{checked:!1,halfCheckedKeys:te},Ne);Ae=ln.checkedKeys}else{var un=De(we,!0,Ne);Ae=un.checkedKeys}var cn=Fe(Ae,Y,U);he=ce(cn)}Ie([].concat(Q(Ee),Q(he)))}}),Ze=function(y,T){if(T.type==="clear"){Ie([]);return}var te=T.values[0],z=te.valueCells;Le(z)},en=f!==void 0?f:q,nn=A||ee,an=u||O,tn=function(y){S==null||S(y),h==null||h(y)},rn=r.useMemo(function(){return{options:ne,fieldNames:J,values:de,halfValues:ge,changeOnSelect:d,onSelect:Le,checkable:g,searchOptions:se,dropdownPrefixCls:V,loadData:L,expandTrigger:k,expandIcon:H,loadingIcon:I,dropdownMenuColumnStyle:b}},[ne,J,de,ge,d,Le,g,se,V,L,k,H,I,b]),$e=!(pe?se:ne).length,on=pe&&ae.matchInputWidth||$e?{}:{minWidth:"auto"};return r.createElement(_e.Provider,{value:rn},r.createElement(vn,je({},G,{ref:n,id:_,prefixCls:o,dropdownMatchSelectWidth:re,dropdownStyle:on,displayValues:Qe,onDisplayValuesChange:Ze,mode:F?"multiple":void 0,searchValue:pe,onSearch:m,showSearch:N,OptionList:wn,emptyOptions:$e,open:en,dropdownClassName:nn,placement:an,onDropdownVisibleChange:tn,getRawInputElement:function(){return $}})))});Ye.SHOW_PARENT=Xe;Ye.SHOW_CHILD=qe;export{Ye as C};
